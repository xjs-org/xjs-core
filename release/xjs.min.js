(function(a,p){typeof exports=="object"&&typeof module<"u"?p(exports):typeof define=="function"&&define.amd?define(["exports"],p):(a=a||self,p(a.XJS={}))})(this,(function(a){"use strict";var p="0.0.1";let b=!1;const{getPrototypeOf:S,entries:_}=Object,y=document,j=S({}),h=[],m=new Set,A=()=>{b=!1;for(const t of m)t();m.clear()},J=(t,n,r)=>{h.push({s:t,e:r});const e=n();return h.pop(),e},N=t=>{let n=t;const r=new Set;return{get value(){const e=h[h.length-1];return e&&r.add(e),n},set value(e){if(e!==n){n=e;for(const o of r){if(o.e&&o.e.nodeType&&!o.e.isConnected){r.delete(o);continue}m.add(o.s)}m.size>0&&!b&&(b=!0,queueMicrotask(A))}},isSignal:!0}},k=t=>t?.nodeType?t:new Text(t??""),O=(t,n)=>t.replaceChild(k(n),t.lastChild),E=(t,n,r)=>{if(typeof n=="function"||n?.isSignal){let e=n.isSignal?()=>n.value:n;return J(()=>t(r,e()),e,r)}return n},P=(t,...n)=>(n.flat(1/0).filter(r=>r).forEach(r=>{let e=E(O,r,t);if(Array.isArray(e))return e.map(o=>P(t,o));t.append(k(e))}),t),C=t=>{let n=t?y.createElementNS.bind(y,t):y.createElement.bind(y);return new Proxy((r,...e)=>{let o=e[0]||0,[f,...c]=S(o)===j?o.isSignal?[{},...e]:e:[{},...e],s=n(r);s.on=(d,i)=>s.addEventListener(d,i)||s;for(let[d,i]of _(f)){if(!i)continue;let l=S(i)===j&&!i.isSignal?(w,q)=>{let x=(v,T)=>s[w][v]=T;_(q).forEach(([v,T])=>x(v,E(x,T,v)))}:(w,q)=>w in s?s[w]=q:s.setAttribute.bind(s),u=d.startsWith("on")?i:E(l,i,d);l(d,u)}return P(s,c)},{get:(r,e)=>r.bind(void 0,e)})};a.version=p,a.createSignal=N,a.appendElements=P,a.htmlProxy=C,a.htmlElements=C(),a.svgElements=C("http://www.w3.org/2000/svg");function z(t="",n={}){return new Proxy(async(r,...e)=>{let[o="",f={}]=typeof e[0]=="string"?e:["",e[0]||{}],c={...n,...f,path:t+o,method:(f.method??r).toUpperCase(),headers:{"Content-Type":"application/json",...n.headers,...f.headers}},s=c.middlewares||[];delete c.middlewares;const d=async i=>{for(const u of s)u.request&&(i=await u.request?.(i)||i);i.body&&typeof i.body!="string"&&(i.body=JSON.stringify(i.body));let l=await fetch(i.path,i);for(const u of s)u.response&&(l=await u.response?.(l,i,d)||l);return l};return d(c)},{get:(r,e)=>r.bind(void 0,e)})}a.apiProxy=z}));
